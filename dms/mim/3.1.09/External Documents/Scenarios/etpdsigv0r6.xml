<?xml version="1.0" encoding="UTF-8"?><signatureText xmlns="urn:hl7-org:v3" mediaType="application/xml">	<!-- example fragment - etpdsigv0r6.xml  04/10/04 editor Charlie McCay -->	<!-- open issues - identifiers and definition for transforms to be confirmed  -->	<!-- the mediaType is fixed to application/xml -->	<!-- note that the signatureText element is from the HL7 message that includes the signature -->	<Signature xmlns="http://www.w3.org/2000/09/xmldsig#">		<SignedInfo>			<!-- The method that is used to produce the canonicalized form of the data within the SignedInfo element -->			<CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>			<!-- The method used for generating and validating signatures -->			<SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#dsa-sha1"/>			<!-- The object that is being digitally signed -->			<Reference URI="urn:nhs-uk:etp-hl7v3-etpid-AEF4F4D6-FE54A-6554-DAECB543E7D9">				<!-- The transforms that have been applied to the object that was digested -->				<Transforms>					<!-- A transform that has been applied, the algorithm that was used is specified here -->					<Transform Algorithm="urn:nhs-uk:etp-signing-transforms-t1">						<!-- A URI that points to the transform -->					</Transform>					<!-- The input to the npfit:ni digest is canonicalised -->					<Transform Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>				</Transforms>				<!-- The method that will be used to create the digest of the signed object (the NPfIT ni method) -->				<DigestMethod Algorithm="urn:nhs-uk:npfit-signing-digest-ni"/>				<!-- The encoded value of the digest -->				<DigestValue>					<npfit:NI xmlns:npfit="urn:nhs-uk:npfit-signing-digest-ni">						<npfit:Ni.part> j6lwx3rvEPO0vKtMup4NbeVu8nk=</npfit:Ni.part>						<!-- each npfit:Ni:part is the base64 encoding of the SHA-1 160 bit string viewed as a 20-octet octet stream.  This follows the pattern set by http://www.w3.org/2000/09/xmldsig#sha1 -->						<npfit:Ni.part> j6lwxsdfsfsdfdfffsdffffdddddssddd</npfit:Ni.part>						<npfit:Ni.part> j6lwxddddddddddddddddddddddd</npfit:Ni.part>						<npfit:Ni.root>j6lweeeeeeeeeeeeeeeeeeeeeeee</npfit:Ni.root>						<!-- npfit:Ni.root contains the SHA-1 hash generated from the concatination of contents of each of the npfit:Ni.part elements (in document order) and the npfit:Ni.nhsno.  It is the base64 encoding of the SHA-1 160 bit string viewed as a 20-octet octet stream -->						<npfit:Ni.nhsno>1234567890</npfit:Ni.nhsno>					</npfit:NI>				</DigestValue>			</Reference>		</SignedInfo>		<!-- The value of the digital signature -->		<SignatureValue>MC0CFFrVLtRlk=...</SignatureValue>		<!-- The key needed to validate the signature -->		<KeyInfo>			<X509Data>				<!--Signer cert base64 encoded as described in        http://www.w3.org/TR/2002/REC-xmldsig-core-20020212/Overview.html#sec-X509Data -->				<X509Certificate>MIICXTCCA..</X509Certificate>			</X509Data>		</KeyInfo>	</Signature></signatureText>